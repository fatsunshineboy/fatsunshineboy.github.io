<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>钉钉开发学习 | sunBlog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/sun.png">
    <meta name="description" content="fatsunshineboy的个人博客">
    
    <link rel="preload" href="/assets/css/0.styles.8fc29a17.css" as="style"><link rel="preload" href="/assets/js/app.b8af9530.js" as="script"><link rel="preload" href="/assets/js/2.d2c14998.js" as="script"><link rel="preload" href="/assets/js/11.4e8abeff.js" as="script"><link rel="prefetch" href="/assets/js/10.33fbe10a.js"><link rel="prefetch" href="/assets/js/12.1be5efaa.js"><link rel="prefetch" href="/assets/js/13.267915e5.js"><link rel="prefetch" href="/assets/js/14.51240391.js"><link rel="prefetch" href="/assets/js/15.911e63e1.js"><link rel="prefetch" href="/assets/js/16.c891e198.js"><link rel="prefetch" href="/assets/js/17.6b166d2e.js"><link rel="prefetch" href="/assets/js/18.5df18872.js"><link rel="prefetch" href="/assets/js/19.9c58ef6b.js"><link rel="prefetch" href="/assets/js/20.b69808b7.js"><link rel="prefetch" href="/assets/js/21.86a7d34e.js"><link rel="prefetch" href="/assets/js/22.b7298ab9.js"><link rel="prefetch" href="/assets/js/23.a5f921f1.js"><link rel="prefetch" href="/assets/js/24.70d24f2e.js"><link rel="prefetch" href="/assets/js/25.64a6549e.js"><link rel="prefetch" href="/assets/js/26.c1918217.js"><link rel="prefetch" href="/assets/js/27.89c49370.js"><link rel="prefetch" href="/assets/js/28.36d9903c.js"><link rel="prefetch" href="/assets/js/29.0907fefb.js"><link rel="prefetch" href="/assets/js/3.005bd3af.js"><link rel="prefetch" href="/assets/js/30.36c9cc05.js"><link rel="prefetch" href="/assets/js/31.8257ad3c.js"><link rel="prefetch" href="/assets/js/32.91d1291d.js"><link rel="prefetch" href="/assets/js/33.0c27517e.js"><link rel="prefetch" href="/assets/js/34.f67c2078.js"><link rel="prefetch" href="/assets/js/35.02fe8093.js"><link rel="prefetch" href="/assets/js/36.e0b1d16c.js"><link rel="prefetch" href="/assets/js/4.a68ff159.js"><link rel="prefetch" href="/assets/js/5.42e8b644.js"><link rel="prefetch" href="/assets/js/6.e416b78d.js"><link rel="prefetch" href="/assets/js/7.cc921ffd.js"><link rel="prefetch" href="/assets/js/8.683bc7a3.js"><link rel="prefetch" href="/assets/js/9.f5342317.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8fc29a17.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/sun.png" alt="sunBlog" class="logo"> <span class="site-name can-hide">sunBlog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front/front_learn/JavaScript_Learn.html" class="nav-link">
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/front/front_project/Snake.html" class="nav-link">
  项目
</a></li></ul></div></div><div class="nav-item"><a href="/back/java.html" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/algorithm/leetcode.html" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/record/" class="nav-link">
  杂记
</a></div> <a href="https://github.com/fatsunshineboy/fatsunshineboy.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front/front_learn/JavaScript_Learn.html" class="nav-link">
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/front/front_project/Snake.html" class="nav-link">
  项目
</a></li></ul></div></div><div class="nav-item"><a href="/back/java.html" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/algorithm/leetcode.html" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/record/" class="nav-link">
  杂记
</a></div> <a href="https://github.com/fatsunshineboy/fatsunshineboy.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端学习</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front/front_learn/Css_learn.html" class="sidebar-link">CSS学习笔记</a></li><li><a href="/front/front_learn/Less_Learn.html" class="sidebar-link">Less学习笔记</a></li><li><a href="/front/front_learn/Scss_Learn.html" class="sidebar-link">Scss学习笔记</a></li><li><a href="/front/front_learn/JavaScript_Learn.html" class="sidebar-link">JavaScript学习笔记</a></li><li><a href="/front/front_learn/JavScript_Attention.html" class="sidebar-link">JavaScript注意事项</a></li><li><a href="/front/front_learn/AJAX_Learn.html" class="sidebar-link">AJAX学习笔记</a></li><li><a href="/front/front_learn/axios.html" class="sidebar-link">axios学习笔记</a></li><li><a href="/front/front_learn/Gulp_Learn.html" class="sidebar-link">Gulp学习笔记</a></li><li><a href="/front/front_learn/TypeScript.html" class="sidebar-link">TypeScript学习经验</a></li><li><a href="/front/front_learn/Vue_Attention.html" class="sidebar-link">Vue注意事项</a></li><li><a href="/front/front_learn/Vuepress_Learn_exprice.html" class="sidebar-link">Vuepress学习经验</a></li><li><a href="/front/front_learn/Nuxt.html" class="sidebar-link">Nuxt学习笔记</a></li><li><a href="/front/front_learn/DingTalk_Learn.html" aria-current="page" class="active sidebar-link">钉钉开发学习经验</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端项目</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="链接"><a href="#链接" class="header-anchor">#</a> 链接</h2> <p><a href="https://open.dingtalk.com/" target="_blank" rel="noopener noreferrer">钉钉开放文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://ding.design/#/" target="_blank" rel="noopener noreferrer">Ding Design<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://open-dev.dingtalk.com/#/" target="_blank" rel="noopener noreferrer">钉钉开发平台<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="基础"><a href="#基础" class="header-anchor">#</a> 基础</h2> <h3 id="钉钉服务端接口"><a href="#钉钉服务端接口" class="header-anchor">#</a> 钉钉服务端接口</h3> <p>调用钉钉服务端接口时，需使用 HTTPS 协议、JSON 数据格式、UTF-8 编码，POST 请求请在 HTTP Header 中设置 <code>Content-Type:application/json</code>。</p> <p>访问域名为：</p> <p>新版服务端接口：https://api.dingtalk.com</p> <p>旧版服务端接口：https://oapi.dingtalk.com</p> <h3 id="第三方企业应用开发"><a href="#第三方企业应用开发" class="header-anchor">#</a> 第三方企业应用开发</h3> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>给第三方企业开发应用有两种方式</p> <ol><li>选择第三方企业应用开发,在本组织开发应用后交付第三方企业</li></ol> <ul><li>交付方式：</li> <li>应用不上架，定向定量分发（授权、静默和扫码）。<a href="https://open.dingtalk.com/document/isv/application-distribution" target="_blank" rel="noopener noreferrer">定向分发<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>应用上架，天元代下单安装，<a href="https://www.yuque.com/xlq/xlq/ssr8nq" target="_blank" rel="noopener noreferrer">天元系统<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li>应用上架，二维码扫码安装。</li> <li>应用上架，广场下单安装。</li> <li>应用预装在工作台内，通过工作台分发安装。</li></ul> <ol start="2"><li>选择企业内部应用开发，由第三方企业授权服务商开发</li></ol></div> <ol><li><p>在开发企业第三方应用前，需要完成入驻成为<a href="https://open.dingtalk.com/document/operation-specification/become-an-application-service-provider" target="_blank" rel="noopener noreferrer">产品方案商<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></li> <li><p>第三方企业应用必须要注册事件回调,钉钉推送的回调事件：</p></li></ol> <blockquote><p>RDS数据推送<br>
SyncHTTP推送<br>
HTTP数据推送（不推荐第三方企业应用使用）</p></blockquote> <ol start="3"><li><p>第三方企业应用需要进行应用授权等开发</p></li> <li><p>第三方企业应用必须接入钉钉免登、通讯录和工作通知能力</p></li> <li><p>开发是H5微应用，需要进行JSAPI鉴权。详情请参考<a href="https://open.dingtalk.com/document/isvapp-client/jsapi-authentication" target="_blank" rel="noopener noreferrer">H5JSAPI鉴权<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></li></ol> <h2 id="开发"><a href="#开发" class="header-anchor">#</a> 开发</h2> <h3 id="免登开发"><a href="#免登开发" class="header-anchor">#</a> 免登开发</h3> <p>免登指企业员工在钉钉内使用第三方企业应用时，无需输入账号密码便可直接登录该应用。建议将用户信息保存在前端缓存（dd.setStorage）或者cookie中，避免每次进入应用都调用钉钉接口进行免登。</p> <p>免登接入流程如下：</p> <ol><li>获取免登授权码Code。
PC端暂不支持小程序开发，如果要开发PC端应用，需使用微应用开发方式。</li></ol> <ul><li><a href="https://open.dingtalk.com/document/isvapp-client/mini-program-free-login" target="_blank" rel="noopener noreferrer">小程序获取免登授权码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://open.dingtalk.com/document/isvapp-client/logon-free-process" target="_blank" rel="noopener noreferrer">H5免登流程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <ol start="2"><li><p>获取access_token。
通过调用service/get_corp_token接口获取企业授权凭证，详情请参考获取第三方应用授权企业的<a href="https://open.dingtalk.com/document/isvapp-server/obtain-the-access_token-of-the-authorized-enterprise" target="_blank" rel="noopener noreferrer">accessToken<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></li> <li><p>获取当前用户的userId。
调用user/getuserinfo接口获取用户的userid，详情请参考<a href="https://open.dingtalk.com/document/isvapp-server/obtain-the-userid-of-a-user-by-using-the-log-free" target="_blank" rel="noopener noreferrer">通过免登码获取用户信息<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></li> <li><p>获取当前用户详情。
通过topapi/v2/user/get接口获取用户详情信息，详情请参考<a href="https://open.dingtalk.com/document/isvapp-server/query-user-details" target="_blank" rel="noopener noreferrer">根据userId获取用户详情<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></li></ol> <h3 id="回调函数"><a href="#回调函数" class="header-anchor">#</a> 回调函数</h3> <p><a href="https://open.dingtalk.com/document/isv/third-party-enterprise-application-address-book-change-event-subscription-process" target="_blank" rel="noopener noreferrer">配置回调函数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="授权应用开通"><a href="#授权应用开通" class="header-anchor">#</a> 授权应用开通</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>小程序使用dd.corpId获取企业corpId，微应用由前端从URL中获取。微应用的首页URL，可以使用$CORPID$做为参数占位符，钉钉容器会将$CORPID$替换为当前访问的企业的corpId。例如:https://www.dingtalk.com?corpId=$CORPID$</p></div> <p><strong>RDS推送（聚石塔/钉钉云）和SyncHTTP推送</strong></p> <p><img src="/assets/img/RDS_app_start.60b95b06.png" alt="RDS"></p> <p><strong>HTTP推送</strong></p> <p>HTTP推送方式下，当企业接收到授权开通事件后，需要依次调用以下三个接口完成应用激活，激活完成后才算授权成功：</p> <ol><li><p>调用<a href="https://open.dingtalk.com/document/isvapp-server/obtains-the-suite_acess_token-of-third-party-enterprise-applications" target="_blank" rel="noopener noreferrer">获取第三方企业应用的suiteAccessToken<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>接口获取第三方应用凭证（suite_access_token）。</p></li> <li><p>调用<a href="https://open.dingtalk.com/document/isvapp-server/obtain-a-permanent-authorization-code" target="_blank" rel="noopener noreferrer">获取授权企业的永久授权码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>接口获取永久授权码。</p></li> <li><p>调用<a href="https://open.dingtalk.com/document/isvapp-server/activate-suite" target="_blank" rel="noopener noreferrer">激活应用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>接口激活企业授权的应用。</p></li></ol> <p>HTTP推送方式下，管理员授权开通应用的流程如下图所示。</p> <p><img src="/assets/img/http_app_start.94e49afc.png" alt="http企业授权"></p> <h3 id="启动时更新"><a href="#启动时更新" class="header-anchor">#</a> 启动时更新</h3> <p>小程序每次冷启动时，都会检查是否有更新版本，如果发现有新版本，将会异步下载新版本的代码包，并同时用客户端本地的包进行启动，即新版本的小程序需要等下一次冷启动才会应用上。如果距离上一次更新版本超过 48 小时，则会等待新版本的代码包被下载后，直接使用新版本启动。</p> <p>如果需要马上应用最新版本，可以使用dd.UpdateManager()API进行处理。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> updateManager <span class="token operator">=</span> dd<span class="token punctuation">.</span><span class="token function">getUpdateManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

updateManager<span class="token punctuation">.</span><span class="token function">onCheckForUpdate</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 请求完新版本信息的回调</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>hasUpdate<span class="token punctuation">)</span> <span class="token comment">// 是否有更新</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

updateManager<span class="token punctuation">.</span><span class="token function">onUpdateReady</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">ret</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ret<span class="token punctuation">.</span>version<span class="token punctuation">)</span> <span class="token comment">// 更新版本号</span>
  dd<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'更新提示'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">'新版本已经准备好，是否重启应用？'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>confirm<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 新的版本已经下载好，调用 applyUpdate 应用新版本并重启</span>
        updateManager<span class="token punctuation">.</span><span class="token function">applyUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
updateManager<span class="token punctuation">.</span><span class="token function">onUpdateFailed</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 新版本下载失败</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="app-json"><a href="#app-json" class="header-anchor">#</a> App.json</h3> <p><strong>window</strong></p> <p><code>window</code>属性用于设置通用的的状态栏、导航条、标题、窗口背景色。子属性如下表所示：</p> <table><thead><tr><th><strong>属性</strong></th> <th><strong>类型</strong></th> <th><strong>必填</strong></th> <th><strong>描述</strong></th></tr></thead> <tbody><tr><td>titleBarColor</td> <td>HexColor</td> <td>否</td> <td>导航栏背景色，HexColor示例：#F5F5F。</td></tr> <tr><td>defaultTitle</td> <td>String</td> <td>否</td> <td>页面标题。</td></tr> <tr><td>defaultTitle_locale</td> <td>Dict&lt;Language, String&gt;</td> <td>否</td> <td>页面标题的多语言配置。</td></tr> <tr><td>pullRefresh</td> <td>Boolean</td> <td>否</td> <td>是否允许下拉刷新，默认为<strong>false</strong>。</td></tr> <tr><td>allowsBounceVertical</td> <td>String</td> <td>否</td> <td>页面是否支持纵向拽拉超出实际内容，默认为<strong>YES</strong>。</td></tr> <tr><td>supportColorScheme</td> <td>Array</td> <td>否</td> <td>支持的显示模式，模式有 light和dark 两种。默认为<strong>light</strong>。</td></tr></tbody></table> <h3 id="tabbar"><a href="#tabbar" class="header-anchor">#</a> tabBar</h3> <p>如果你的小程序是一个多 tab 应用（客户端窗口的底部栏可以切换页面），那么可以通过<code>tabBar</code>配置项指定 tab 栏的表现，以及 tab 切换时显示的对应页面。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>通过页面跳转（<code>dd.navigateTo</code>）或者页面重定向（<code>dd.redirectTo</code>）所到达的页面，即使它是定义在 tabBar 配置中的页面，也不会显示底部的 tab 栏。另外，tabBar的第一个页面必须是首页。</p></div> <table><thead><tr><th><strong>属性</strong></th> <th><strong>类型</strong></th> <th><strong>必填</strong></th> <th><strong>描述</strong></th></tr></thead> <tbody><tr><td>textColor</td> <td>HexColor</td> <td>否</td> <td>文字颜色。</td></tr> <tr><td>selectedColor</td> <td>HexColor</td> <td>否</td> <td>选中文字颜色。</td></tr> <tr><td>backgroundColor</td> <td>HexColor</td> <td>否</td> <td>背景色。</td></tr> <tr><td>items</td> <td>Array</td> <td>是</td> <td>每个 tab 配置。</td></tr> <tr><td>colorSchemes</td> <td>Dict&lt;Scheme, Config&gt;</td> <td>否</td> <td>显示模式对应的 tabBar 配置。</td></tr></tbody></table> <p>每个 <code>item</code> 的属性配置如下表所示:</p> <table><thead><tr><th><strong>属性</strong></th> <th><strong>类型</strong></th> <th><strong>必填</strong></th> <th><strong>描述</strong></th></tr></thead> <tbody><tr><td>pagePath</td> <td>String</td> <td>是</td> <td>设置页面路径。</td></tr> <tr><td>name</td> <td>String</td> <td>是</td> <td>名称。</td></tr> <tr><td>name_locale</td> <td>Dict&lt;Language, String&gt;</td> <td>否</td> <td>item名称的多语言配置。</td></tr> <tr><td>icon</td> <td>String</td> <td>否</td> <td>平常图标路径。</td></tr> <tr><td>activeIcon</td> <td>String</td> <td>否</td> <td>高亮图标路径。</td></tr> <tr><td>colorSchemes</td> <td>Dict&lt;Scheme, Config&gt;</td> <td>否</td> <td>显示模式对应的 tabBar Item 配置。</td></tr></tbody></table> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>icon 推荐大小为 60*60px 大小，系统会对任意传入的图片非等比拉伸/缩放。</p></div> <p>示例代码：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;tabBar&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;textColor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;#dddddd&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;selectedColor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;#49a9ee&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;backgroundColor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;#ffffff&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;items&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;pagePath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pages/index/index&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;首页&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;pagePath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pages/logs/logs&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;日志&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="page"><a href="#page" class="header-anchor">#</a> Page</h3> <p><code>Page()</code>方法的参数说明如下：</p> <table><thead><tr><th><strong>属性</strong></th> <th><strong>类型</strong></th> <th><strong>描述</strong></th></tr></thead> <tbody><tr><td>data</td> <td>Object or Function</td> <td>初始数据或返回初始化数据的函数。</td></tr> <tr><td>onTitleClick</td> <td>Function</td> <td>点击标题触发。</td></tr> <tr><td>onPageScroll</td> <td>Function({scrollTop})</td> <td>页面滚动时触发。</td></tr> <tr><td>onLoad</td> <td>Function(query: Object)</td> <td>页面加载时触发。</td></tr> <tr><td>onReady</td> <td>Function</td> <td>页面初次渲染完成时触发。</td></tr> <tr><td>onShow</td> <td>Function</td> <td>页面显示时触发。</td></tr> <tr><td>onHide</td> <td>Function</td> <td>页面隐藏时触发。</td></tr> <tr><td>onUnload</td> <td>Function</td> <td>页面卸载时触发。</td></tr> <tr><td>onPullDownRefresh</td> <td>Function</td> <td>页面下拉时触发。</td></tr> <tr><td>onReachBottom</td> <td>Function</td> <td>上拉触底时触发。</td></tr> <tr><td>onShareAppMessage</td> <td>Function</td> <td>点击右上角分享时触发。</td></tr> <tr><td>其他</td> <td>Any</td> <td>开发者可以添加任意的函数或属性到 <code>object</code>参数中，在页面的函数中可以用 <code>this</code>来访问。</td></tr></tbody></table> <hr> <p><strong>Page.prototype.$batchedUpdates(callback: Function)</strong></p> <p><em>说明</em></p> <p><code>$batchedUpdates</code>自1.14.0之后才支持，可以使用<code>dd.canIUse('page.$batchedUpdates')</code>做兼容性处理，详情请参考<a href="https://open.dingtalk.com/document/app/dd-caniuse#topic-2024690" target="_blank" rel="noopener noreferrer">dd.canIUse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p><em>参数说明</em></p> <table><thead><tr><th><strong>事件</strong></th> <th><strong>类型</strong></th> <th><strong>描述</strong></th></tr></thead> <tbody><tr><td>callback</td> <td>Function</td> <td>在此回调函数中的数据操作会被批量更新。</td></tr></tbody></table> <p><em>示例代码</em></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// pages/index/index.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">counter</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">plus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$batchedUpdates</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">counter</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">counter</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> pages<span class="token operator">/</span>index<span class="token operator">/</span>index<span class="token punctuation">.</span>axml <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>counter<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button onTap<span class="token operator">=</span><span class="token string">&quot;plus&quot;</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
</code></pre></div><ul><li>本示例中每次点击按钮，页面的<code>counter</code> 会加 2。</li> <li>将 <code>setData</code> 放在this.$batchedUpdates中，这样尽管有多次<code>setData</code>，但是却只有一次数据的传输。</li></ul> <h3 id="axml"><a href="#axml" class="header-anchor">#</a> AXMl</h3> <p><strong>import</strong></p> <p><code>import</code>可以加载已经定义好的<code>template</code>。</p> <p>例如，在<code>item.axml</code>中定义了一个叫<code>item</code>的<code>template</code>。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- item.axml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{text}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>在<code>index.axml</code>中引用<code>item.axml</code>，就可以使用<code>item</code>模板。</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;import src=&quot;./item.axml&quot;/&gt;
&lt;template is=&quot;item&quot; data=&quot;{{text: 'forbar'}}&quot;/&gt;
</code></pre></div><p><code>import</code>有作用域的概念，只会<code>import</code>目标文件中定义的<code>template</code>。比如，C import B，B import A，在<code>C</code>中可以使用<code>B</code>定义的<code>template</code>，在<code>B</code>中可以使用<code>A</code>定义的<code>template</code>，但是<code>C</code>不能使用<code>A</code>中定义的<code>template</code>。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- A.axml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span> A template <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- B.axml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./a.axml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>B<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span> B template <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- C.axml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./b.axml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>A<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  <span class="token comment">&lt;!-- Error! Can not use tempalte when not import A. --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>B<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>注意：template 的子节点只能是一个而不是多个。</p> <p>允许示例代码：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>x<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>不允许示例代码：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>x<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>include</strong></p> <p><code>include</code>可以将目标文件除了<code>&lt;template/&gt;</code>的整个代码引入，相当于是拷贝到<code>include</code>位置。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- index.axml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./header.axml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span> body <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./footer.axml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token comment">&lt;!-- header.axml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span> header <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- footer.axml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span> footer <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>AXML提供模板（template），可以在模板中定义代码片段，在不同的地方调用。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>此处 template 区别于 slot，slot 可参考<a href="https://open.dingtalk.com/document/isvapp-client/development-process#topic-2024614" target="_blank" rel="noopener noreferrer">开发自定义组件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></div> <p><strong>定义模板</strong></p> <p>使用<code>name</code>属性，作为模板的名字，然后在<code>&lt;template/&gt;</code>内定义代码片段。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!--
  index: int
  msg: string
  time: string
--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msgItem<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span> {{index}}: {{msg}} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span> Time: {{time}} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>使用模板</strong></p> <p>使用<code>is</code>属性，声明需要使用的模板，然后将该模板所需要的<code>data</code>传入，例如：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msgItem<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{...item}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
Page({
  data: {
    item: {
      index: 0,
      msg: 'this is a template',
      time: '2016-09-15'
    }
  }
})
</code></pre></div><p><code>is</code>属性可以使用<code>Mustache</code>语法，来动态决定具体需要渲染哪个模板。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>odd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span> odd <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>even<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span> even <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">a:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{[1, 2, 3, 4, 5]}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item % 2 == 0 ? <span class="token punctuation">'</span>even<span class="token punctuation">'</span> : <span class="token punctuation">'</span>odd<span class="token punctuation">'</span>}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>模板作用域</strong></p> <p>模板拥有自己的作用域，只能用<code>data</code>传入的数据，但可以通过 <code>onXX</code> 绑定页面的逻辑处理函数。</p> <p>推荐用 template 方式来引入模版片段，因为 template 会指定自己的作用域，只使用<code>data</code>传入的数据，因此应用会对此进行优化。如果该 template 的 data 没有改变，该片段 UI 并不会重新渲染。</p> <p>引入路径支持从 node_modules 目录载入第三方模块，例如 page.axml:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./a.axml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> <span class="token comment">&lt;!-- 相对路径 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/a.axml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> <span class="token comment">&lt;!-- 项目绝对路径 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>third-party/x.axml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> <span class="token comment">&lt;!-- 第三方 npm 包路径 --&gt;</span>
</code></pre></div><h3 id="sjs"><a href="#sjs" class="header-anchor">#</a> SJS</h3> <table><thead><tr><th><strong>属性</strong></th> <th><strong>类型</strong></th> <th><strong>是否必填</strong></th> <th><strong>说明</strong></th></tr></thead> <tbody><tr><td>name</td> <td>String</td> <td>是</td> <td>当前<code>&lt;import-sjs&gt;</code> 标签的模块名。</td></tr> <tr><td>from</td> <td>String</td> <td>是</td> <td>引用 .sjs 文件的相对路径。</td></tr></tbody></table> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>sjs 中只支持使用 import、export 管理模块依赖。</li> <li>sjs 只能定义在 <code>.sjs</code>文件中，然后在 axml 中使用 <code>&lt;import-sjs&gt;</code>标签引入。</li> <li>sjs 可以调用其他 sjs 文件中定义的函数。</li> <li>sjs 是 JavaScript 语言的子集，请勿将其等同于 JavaScript。</li> <li>sjs 的运行环境和其他 JavaScript 代码是隔离的，sjs 中不能调用其他 JavaScript 文件中定义的函数，也不能调用小程序提供的 API。</li> <li>sjs 函数不能作为组件事件回调。</li> <li>sjs 不依赖于基础库版本，可以在所有版本小程序中运行。</li></ul></div> <p><strong>使用方式</strong></p> <p>在 index.sjs 文件中定义 SJS：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// pages/index/index.sjs</span>
<span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token string">'hello dingtalk'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">getMsg</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  message<span class="token punctuation">,</span>
  getMsg<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>index.js示例代码：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// pages/index/index.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'hello taobao'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>index.axml示例代码：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- pages/index/index.axml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import-sjs</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>m1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./index.sjs<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{m1.message}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{m1.getMsg(msg)}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>页面输出：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>hello dingtalk
hello taobao
</code></pre></div><h3 id="授权登录"><a href="#授权登录" class="header-anchor">#</a> 授权登录</h3> <p><a href="https://open.dingtalk.com/document/isvapp-client/overview" target="_blank" rel="noopener noreferrer">统一授权套件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="开发流程"><a href="#开发流程" class="header-anchor">#</a> 开发流程</h3> <p>准备工作：</p> <ol><li>入驻成为产品方案商，详情参见文档入驻成为产品方案商。</li> <li>需要成为钉钉开发者，详情参见成为钉钉开发者</li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/fatsunshineboy/fatsunshineboy.github.io/edit/main/docs/front/front_learn/DingTalk_Learn.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">11/19/2022, 2:13:36 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/front/front_learn/Nuxt.html" class="prev">
        Nuxt学习笔记
      </a></span> <span class="next"><a href="/front/front_project/Snake.html">
        贪吃蛇
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><section class="side-anchor"><ul style="display:none;"></ul></section></div></div>
    <script src="/assets/js/app.b8af9530.js" defer></script><script src="/assets/js/2.d2c14998.js" defer></script><script src="/assets/js/11.4e8abeff.js" defer></script>
  </body>
</html>
