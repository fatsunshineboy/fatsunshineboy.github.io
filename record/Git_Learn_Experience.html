<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>sunBlog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/sun.png">
    <meta name="description" content="fatsunshineboy的个人博客">
    
    <link rel="preload" href="/assets/css/0.styles.8fc29a17.css" as="style"><link rel="preload" href="/assets/js/app.49f5c377.js" as="script"><link rel="preload" href="/assets/js/2.d2c14998.js" as="script"><link rel="preload" href="/assets/js/5.42e8b644.js" as="script"><link rel="prefetch" href="/assets/js/10.33fbe10a.js"><link rel="prefetch" href="/assets/js/11.f902ccd3.js"><link rel="prefetch" href="/assets/js/12.602ef32c.js"><link rel="prefetch" href="/assets/js/13.267915e5.js"><link rel="prefetch" href="/assets/js/14.51240391.js"><link rel="prefetch" href="/assets/js/15.911e63e1.js"><link rel="prefetch" href="/assets/js/16.c891e198.js"><link rel="prefetch" href="/assets/js/17.6b166d2e.js"><link rel="prefetch" href="/assets/js/18.5df18872.js"><link rel="prefetch" href="/assets/js/19.9c58ef6b.js"><link rel="prefetch" href="/assets/js/20.b69808b7.js"><link rel="prefetch" href="/assets/js/21.86a7d34e.js"><link rel="prefetch" href="/assets/js/22.b7298ab9.js"><link rel="prefetch" href="/assets/js/23.a5f921f1.js"><link rel="prefetch" href="/assets/js/24.c21ddb64.js"><link rel="prefetch" href="/assets/js/25.5aee627f.js"><link rel="prefetch" href="/assets/js/26.c1918217.js"><link rel="prefetch" href="/assets/js/27.89c49370.js"><link rel="prefetch" href="/assets/js/28.36d9903c.js"><link rel="prefetch" href="/assets/js/29.0907fefb.js"><link rel="prefetch" href="/assets/js/3.005bd3af.js"><link rel="prefetch" href="/assets/js/30.25cee870.js"><link rel="prefetch" href="/assets/js/31.8257ad3c.js"><link rel="prefetch" href="/assets/js/32.91d1291d.js"><link rel="prefetch" href="/assets/js/33.0c27517e.js"><link rel="prefetch" href="/assets/js/34.f67c2078.js"><link rel="prefetch" href="/assets/js/35.02fe8093.js"><link rel="prefetch" href="/assets/js/36.e0b1d16c.js"><link rel="prefetch" href="/assets/js/4.a68ff159.js"><link rel="prefetch" href="/assets/js/6.d6278f0b.js"><link rel="prefetch" href="/assets/js/7.cc921ffd.js"><link rel="prefetch" href="/assets/js/8.683bc7a3.js"><link rel="prefetch" href="/assets/js/9.f5342317.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8fc29a17.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/sun.png" alt="sunBlog" class="logo"> <span class="site-name can-hide">sunBlog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front/front_learn/JavaScript_Learn.html" class="nav-link">
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/front/front_project/Snake.html" class="nav-link">
  项目
</a></li></ul></div></div><div class="nav-item"><a href="/back/java.html" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/algorithm/leetcode.html" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/record/" class="nav-link router-link-active">
  杂记
</a></div> <a href="https://github.com/fatsunshineboy/fatsunshineboy.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front/front_learn/JavaScript_Learn.html" class="nav-link">
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/front/front_project/Snake.html" class="nav-link">
  项目
</a></li></ul></div></div><div class="nav-item"><a href="/back/java.html" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/algorithm/leetcode.html" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/record/" class="nav-link router-link-active">
  杂记
</a></div> <a href="https://github.com/fatsunshineboy/fatsunshineboy.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/record/" aria-current="page" class="sidebar-link">杂记</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>git</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/record/Git_Learn_Experience.html" aria-current="page" class="active sidebar-link">git学习经验</a></li><li><a href="/record/Git_Difficult.html" class="sidebar-link">git疑难杂点</a></li><li><a href="/record/Git_Problem.html" class="sidebar-link">git错误问题</a></li></ul></section></li><li><a href="/record/Linux_Learn.html" class="sidebar-link">Linux命令学习</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="git基础"><a href="#git基础" class="header-anchor">#</a> Git基础</h2> <h3 id="git安装"><a href="#git安装" class="header-anchor">#</a> Git安装</h3> <ul><li>windows从git官网<a href="https://git-scm.com/downloads" target="_blank" rel="noopener noreferrer">下载安装程序<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Linux安装</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">git</span>
</code></pre></div><h3 id="git配置"><a href="#git配置" class="header-anchor">#</a> Git配置</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">git</span> config --global user.name <span class="token string">&quot;Your Name&quot;</span>
$ <span class="token function">git</span> config --global user.email <span class="token string">&quot;email@example.com&quot;</span>
<span class="token comment">#配置别名</span>
<span class="token function">git</span> config --global alias.lg <span class="token string">&quot;log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit&quot;</span>
</code></pre></div><h3 id="git使用"><a href="#git使用" class="header-anchor">#</a> Git使用</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token number">1</span>. 创建版本库
$ <span class="token function">git</span> init

<span class="token number">2</span>. 把文件添加到仓库
$ <span class="token function">git</span> <span class="token function">add</span> <span class="token punctuation">[</span>file1<span class="token punctuation">]</span> <span class="token punctuation">[</span>file2<span class="token punctuation">]</span> <span class="token punctuation">..</span>.

<span class="token number">3</span>. 把文件提交到本地仓库
$ <span class="token function">git</span> commit <span class="token punctuation">[</span>file1<span class="token punctuation">]</span> <span class="token punctuation">[</span>file2<span class="token punctuation">]</span> <span class="token punctuation">..</span>. -m <span class="token punctuation">[</span>message<span class="token punctuation">]</span>

<span class="token number">4</span>. 关联远程仓库
$ <span class="token function">git</span> remote <span class="token function">add</span> <span class="token punctuation">[</span>远程仓库别名<span class="token punctuation">]</span> <span class="token operator">&lt;</span>远程仓库URL<span class="token operator">&gt;</span>

<span class="token number">5</span>.推送到远程仓库
$ <span class="token function">git</span> push <span class="token punctuation">[</span>远程仓库别名<span class="token punctuation">]</span> <span class="token operator">&lt;</span>branch<span class="token operator">&gt;</span>
</code></pre></div><h2 id="git修改文件"><a href="#git修改文件" class="header-anchor">#</a> Git修改文件</h2> <h3 id="版本回退"><a href="#版本回退" class="header-anchor">#</a> 版本回退</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#版本回退</span>
$ <span class="token function">git</span> reset --hard HEAD^
$ <span class="token function">git</span> reset --hard <span class="token operator">&lt;</span>commit_id<span class="token operator">&gt;</span>
<span class="token comment">#记录每一次命令(防止回退错误)</span>
$ <span class="token function">git</span> reflog
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>注意^与~之间的区别，当存在多个分支时，^可以用来选择分支，HEAD~i永远只选择第i级父节点的第一个分支，以此类推；HEAD^=HEAD^1=HEAD~1；如果没有分支，只有一条主线，则HEAD^^^=HEAD^1^1^1=HEAD~3，如果该级节点有第二个分支，则表示为：HEAD^^^2 = HEAD~2^2</p> <div class="language- extra-class"><pre class="language-text"><code>G   H   I   J
 \ /     \ /
  D   E   F
   \  |  / \
    \ | /   |
     \|/    |
      B     C
       \   /
        \ /
         A
A =      = A^0
B = A^   = A^1     = A~1
C = A^2  = A^2
D = A^^  = A^1^1   = A~2
E = B^2  = A^^2
F = B^3  = A^^3
G = A^^^ = A^1^1^1 = A~3
H = D^2  = B^^2    = A^^^2  = A~2^2
I = F^   = B^3^    = A^^3^
J = F^2  = B^3^2   = A^^3^2
</code></pre></div></div> <h3 id="撤销修改"><a href="#撤销修改" class="header-anchor">#</a> 撤销修改</h3> <p>场景1：修改了工作区某个文件的内容，但没有添加到暂存区，想直接丢弃工作区的修改时，用命令<code>git restore &lt;filename&gt;</code></p> <p>场景2：当修改了工作区某个文件的内容，还添加到了暂存区时，想丢弃所有修改，分两步，第一步用命令<code>git restore --staged &lt;filnamne&gt;</code>，就回到了场景1，第二步按场景1操作。</p> <p>场景3：已经提交了不合适的修改到版本库时，想要撤销本次提交，使用版本回退</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ol><li><code>--source</code>可以指定文件 <code>git restore &lt;filename&gt; --source HEAD &lt;filename&gt;</code></li> <li>在未给定 source 的情况下，如果使用 <code>--staged</code> ，从 <code>HEAD</code> 恢复(覆盖)暂存区，否则从暂存区恢复(覆盖)工作区</li></ol></div> <h3 id="撤销删除"><a href="#撤销删除" class="header-anchor">#</a> 撤销删除</h3> <ol><li>删除文件</li></ol> <blockquote><p><strong>1. 手动在工作区删除文件</strong><br>
使用<code>git rm &lt;filename&gt;</code>和<code>git add&lt;filename&gt;</code>效果一样，都将添加到暂存区<br> <strong>2. 直接使用<code>git rm &lt;filename&gt;</code></strong><br>
会自动删除工作区的文件，并且直接添加到暂存区</p></blockquote> <ol start="2"><li>撤销删除</li></ol> <blockquote><p>方法同<a href="#%E6%92%A4%E9%94%80%E4%BF%AE%E6%94%B9">撤销修改</a></p></blockquote> <h3 id="commit合并"><a href="#commit合并" class="header-anchor">#</a> commit合并</h3> <p><a href="https://zhuanlan.zhihu.com/p/139321091" target="_blank" rel="noopener noreferrer">文章来源<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Git 合并多个提交的正确方式</p> <ol><li><p>应用场景
对于一个项目，你可能会多次提交代码，每次提交都对应一commit sha，当完成项目，要进行分支合并的时候，只想保留一个或某几个 commit，这时候就需要合并 commit 了。
<img src="/assets/img/commit_rebase1.d62518ec.jpg" alt="alt"></p></li> <li><p>如何合并
这里介绍两种方式，第一种是git rebase，第二种是git rebase --autosquash，后者在git commit时是有条件的。</p></li></ol> <p>1） git rebase
第一步，开启交互模式</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> rebase -i <span class="token operator">&lt;</span>commit_sha<span class="token operator">&gt;</span>
</code></pre></div><p>注意，这里的 <code>&lt;commit_sha&gt;</code> 是你针对此项目第一个提交的前一个提交的commit。</p> <p>举个例子：</p> <p>下面是工作中的提交记录：</p> <p><img src="/assets/img/commit_rebase2.e2ec713f.jpg" alt="alt"></p> <p>这时我们想要把前七个 <code>commit</code> 合并成一个，即：</p> <p><img src="/assets/img/commit_rebase3.1e4129de.jpg" alt="alt"></p> <p>其中 <code>commit_sha</code> 是第一个提交的前一个提交的哈希。 因此，在我的示例中，命令为：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> rebase -i 6394dc
</code></pre></div><p>第二步，摘取合并</p> <p>这时候会弹出一个框，列出了你想要合并的所有 <code>commit</code> 。注意列出的顺序是从老到新的。</p> <p><img src="/assets/img/commit_rebase4.99f62fd2.jpg" alt="alt"></p> <p>更改 <code>commit_sha</code> 最前面的单词，我们打算把这七个合并成一个 <code>commit</code>，那么更改如下：</p> <p><img src="/assets/img/commit_rebase5.3b0fce7a.jpg" alt="alt"></p> <p>保存退出后，又弹出一个新的框，让我们更改 <code>commit</code> 信息，编辑完后退出就好了。最后完成的效果如下：</p> <p><img src="/assets/img/commit_rebase6.a3b3d4d0.png" alt="alt"></p> <ol><li>git rebase --autosquash</li></ol> <p>顾名思义，就是会自动帮你压缩 <code>commit</code>。但是你在 <code>git commit</code> 的时候需要使用特殊命令：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> commit --fixup<span class="token operator">=</span><span class="token operator">&lt;</span>commit_sha<span class="token operator">&gt;</span>
</code></pre></div><p>这里的 <code>commit_sha</code> 是指你对哪个 <code>commit</code> 进行了更改，所以必须先至少存在一个对该项目的提交。</p> <p>举个例子：</p> <p>下面是工作中的提交记录：</p> <p><img src="/assets/img/commit_rebase7.8994721a.png" alt="alt"></p> <p>我现在有有了一个新的改动，那么在提交时，就需要用如下命令表明我是对上一个 <code>commit</code> 进行了更改：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> commit --fixup<span class="token operator">=</span>d94e78
</code></pre></div><p>产生的效果是这样的：</p> <p><img src="/assets/img/commit_rebase8.8e736405.png" alt="alt"></p> <p>这时候又有了一个新的改动，那么提交时的命令不变：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> commit --fixup<span class="token operator">=</span>d94e78
</code></pre></div><p>产生的效果：</p> <p><img src="/assets/img/commit_rebase9.246508e5.jpg" alt="alt"></p> <p>接下来我们进行合并操作：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> rebase --autosquash -i <span class="token operator">&lt;</span>commit_sha<span class="token operator">&gt;</span>
</code></pre></div><p>注意，这里的 <code>commit_sha</code> 是 older commit <code>6394dc</code>。</p> <p>Git这时会很机智的补全单词，不需要手动输入了。</p> <p><img src="/assets/img/commit_rebase10.72c90850.png" alt="alt"></p> <p>直接保存退出，重新编辑提交信息即可。</p> <p>以上两种方式，一种是提交时轻松，合并时麻烦，另外一种相反。可以根据喜好来选择使用。</p> <h2 id="bug修改"><a href="#bug修改" class="header-anchor">#</a> Bug修改</h2> <ol><li>创建新分支修复bug，此时正在开发的分支有工作没有提交，使用<code>git stash</code>将当前工作储存</li> <li>在哪个分支上改Bug，就在哪个分支创建临时分支，完成后合并分支，删除临时分支</li> <li><code>git stash list</code>查看之前保存的工作现场</li> <li>恢复工作现场</li></ol> <blockquote><p>一是用<code>git stash apply</code>恢复，但是恢复后，stash内容并不删除，需要用<code>git stash drop</code>来删除;<br>
另一种方式是用<code>git stash pop</code>，恢复的同时把stash内容也删了</p></blockquote> <ol start="5"><li>将修改的Bug的那次提交复制给其他分支<code>git cherry-pick &lt;commit_id&gt;</code></li></ol> <h2 id="分支管理"><a href="#分支管理" class="header-anchor">#</a> 分支管理</h2> <ol><li>分支关联</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#如果省略远程分支名，则表示将本地分支推送与之存在&quot;追踪关系&quot;的远程分支（通常两者同名），</span>
<span class="token comment">#如果该远程分支不存在，则会被新建，但本地和远程没有关联</span>
$ <span class="token function">git</span> push <span class="token operator">&lt;</span>远程主机名<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>本地分支名<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>远程分支名<span class="token operator">&gt;</span>
$ <span class="token function">git</span> pull <span class="token operator">&lt;</span>远程主机名<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>远程分支<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>本地分支<span class="token operator">&gt;</span>

<span class="token comment">#在远程创建一个与本地branch_name同名的分支并追踪</span>
$ <span class="token function">git</span> push --set-upstream origin branch_name
$ <span class="token function">git</span> push -u origin branch_name

<span class="token comment">#如果省略本地分支名，则表示删除指定的远程分支，因为这等同于推送一个空的本地分支到远程分支。</span>
$ <span class="token function">git</span> push origin :master <span class="token comment"># 等同于 $ git push origin --delete master</span>

<span class="token comment">#创建本地分支跟踪分支&lt;本地分支名&gt;，并从远程分支&lt;远程主机名&gt;/&lt;远程分支名&gt;拉取代码。</span>
<span class="token function">git</span> branch --track <span class="token operator">&lt;</span>本地分支名<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>远程主机名<span class="token operator">&gt;</span>/<span class="token operator">&lt;</span>远程分支名<span class="token operator">&gt;</span>
<span class="token function">git</span> switch -c <span class="token operator">&lt;</span>本地分支名<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>远程主机名<span class="token operator">&gt;</span>/<span class="token operator">&lt;</span>远程分支名<span class="token operator">&gt;</span>
<span class="token function">git</span> checkout -b <span class="token operator">&lt;</span>本地分支名<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>远程主机名<span class="token operator">&gt;</span>/<span class="token operator">&lt;</span>远程分支名<span class="token operator">&gt;</span>

<span class="token comment">#远程新建了一个分支，本地没有该分支，命令会在本地新建分支branch_name，并自动跟踪</span>
$ <span class="token function">git</span> checkout --track origin/branch_name

<span class="token comment">#建立当前分支与指定远程分支的追踪关系，但不会拉取代码。参数&quot;-u&quot;和&quot;--set-upstream-to&quot;同样用处。</span>
$ <span class="token function">git</span> branch -u <span class="token operator">&lt;</span>远程主机名<span class="token operator">&gt;</span>/<span class="token operator">&lt;</span>远程分支名<span class="token operator">&gt;</span>
$ <span class="token function">git</span> branch --set-upstream-to <span class="token operator">&lt;</span>远程主机名<span class="token operator">&gt;</span>/<span class="token operator">&lt;</span>远程分支名<span class="token operator">&gt;</span>
</code></pre></div><ol start="2"><li>分支操作命令</li></ol> <table><thead><tr><th>分支操作</th> <th>命令</th></tr></thead> <tbody><tr><td>创建分支</td> <td><code>git branch &lt;name&gt;</code><br>创建叫name的分支，但仍然停留在当前分支。</td></tr> <tr><td>删除分支</td> <td><code>git branch -d &lt;name&gt;</code>：参数为-D则为强制删除。<br><code>git push origin --delete &lt;name&gt;</code> ：删除远程仓库的叫name的分支，同名的本地分支并不会被删除，所以还需要单独删除本地同名分支<br><code>git branch -dr &lt;remote&gt;/&lt;branch-name&gt;</code>：没有删除远程分支，只是删除 git branch -r 列表中的追踪分支。一般只有git push命令可以修改远程仓库。<br></td></tr> <tr><td>切换分支</td> <td><code>git switch &lt;name&gt;</code><br><code>git checkout &lt;name&gt;</code></td></tr> <tr><td>创建+切换分支</td> <td><code>git switch -c &lt;name&gt;</code><br><code>git checkout -b &lt;name&gt;</code><br>上方两条命令一个意思：如果分支存在则只切换分支。不存在则创建叫name的分支，然后切换到该分支。相当于两条命令：<code>git branch &lt;name&gt;</code>，<code>git checkout &lt;name&gt;</code></td></tr> <tr><td>查看分支</td> <td><code>git branch</code>：查看本地分支，当前分支前面会标一个*号。<br><code>git branch -r</code>：查看远程分支。<br><code>git branch -a</code>：查看本地分支和远程分支，远程分支会用红色表示出来（如果你开了颜色支持的话）。<br><code>git branch -vv</code>：查看本地分支对应的远程分支。</td></tr> <tr><td>重命名分支</td> <td>git branch -m oldName newName</td></tr></tbody></table> <h2 id="开发小结"><a href="#开发小结" class="header-anchor">#</a> 开发小结</h2> <ol><li>关联远程仓库时，调用<code>git branch -vv</code>查看分支关联状态，确保分支建立联系<br> <code>git branch --set-upstream-to &lt;远程仓库别名&gt;/&lt;远程仓库分支&gt;</code></li></ol> <h2 id="应用场景"><a href="#应用场景" class="header-anchor">#</a> 应用场景</h2> <h3 id="fork-pull-协作模式"><a href="#fork-pull-协作模式" class="header-anchor">#</a> “Fork + Pull”协作模式</h3> <p>存在一个&quot;公共主库&quot;，最新代码都是从&quot;公共主库&quot;拉取，fork了一个&quot;公共主库的项目&quot;到自己的账号下为&quot;自己拥有的远程仓库&quot;，以后提交代码前都是从&quot;公共主库&quot;拉取最新代码。我们只能向&quot;自己拥有的远程仓库&quot;推送代码，只有在经过项目组其他成员的review后我们才能从&quot;自己拥有的远程仓库&quot;向&quot;公共仓库&quot;提交合并请求，实现最后的代码合并。这样做能实现能减少多人开发代码提交冲突，而且我们提交代码只是向自己账号下的fork仓库提交不存在提交冲突。每次的开发需求都创建一个特定的开发分支，通过分支区分代码，方便代码回滚。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Git 修改指定远程仓库的push地址</span>
<span class="token function">git</span> remote set-url --push <span class="token operator">&lt;</span>远程仓库别名<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>远程仓库URL<span class="token operator">&gt;</span>
</code></pre></div><ol><li>仓库管理员 设置代码审查</li></ol> <blockquote><p>设置指定人员为某仓库默认的代码审核/测试人员后，每当有新的Pull Request以此仓库内分支为目标分支时，系统会通知指定人员前去审查提交的Pull Request（也就是改动的代码内容），同时也可以设置合并Pull Request的门槛（例如是否需要全部指定人员同意才可以合并）。</p></blockquote> <ol start="2"><li>开发者 提交Pull Request</li></ol> <blockquote><p>开发者通过 Fork仓库的分支向源仓库的分支 或 同仓库内的工作分支向源分支 提交Pull Request的方式来发起一个代码审查的请求，以达到更新源分支的代码的目的。</p></blockquote> <ol start="3"><li>审查者 进行代码审核/测试</li></ol> <blockquote><p>指定人员查看开发者提交的Pull Request内容，并决定是否同意接受该开发者的改动。</p></blockquote> <ol start="4"><li>仓库管理员 合并 Pull Request</li></ol> <blockquote><p>仓库的管理人员在审查者同意后，即可通过合并Pull Request的方式把开发者的文件改动内容同步到源分支。</p></blockquote> <h3 id="多分支模式"><a href="#多分支模式" class="header-anchor">#</a> 多分支模式</h3> <ul><li>master ： 生产分支，即该分支与当前生产代码版本一致。</li> <li>develop ： 开发分支，该分支为当前开发版本分支，每个里程碑结点都须先合并到master，再进行后续开发。</li> <li>hotfix ：补丁分支，该分支用于修复生产BUG，在修复问题前，从master分支派生而来，修复完成后，将该分支分别合并到 master和develop分支。<br> <img src="/imgs/record/git_problem/%E5%A4%9A%E5%88%86%E6%94%AF%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F.png" alt="多分支开发模式"></li></ul> <ol><li>项目git仓库创建完成后，基于 master分支 创建 develop分支，项目团队的功能开发均在develop分支上进行；</li> <li>产品首次发布生产版本时，先将 develop分支 的代码合并到master分支，并从合并后的master分支打包项目部署生产。</li> <li>产品后续功能迭代开发继续在develop分支进行。</li> <li>当生产版本发现重大BUG需要紧急修复时，基于当前master分支创建hotfix分支，并在hotfix分支上修复该BUG。hotfix分支上完成BUG修复后，将该分支代码分别合并到master分支和develop分支。合并完成后，master分支代码打包发布生产修复BUG；develop分支继续后续功能开发。</li></ol> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>注意：每次生产发布关键版本，建议对该版本打tag，以便代码控制和版本对比。</p></div> <h2 id="git常用命令"><a href="#git常用命令" class="header-anchor">#</a> Git常用命令</h2> <ol><li>git add</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#一次性添加所有可用的文件</span>
$ <span class="token function">git</span> <span class="token function">add</span> -A
$ <span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
<span class="token comment">#增加更新和新创建的文件,忽略删除的文件</span>
$ <span class="token function">git</span> <span class="token function">add</span> --ignore-removal <span class="token builtin class-name">.</span>
<span class="token comment">#增加修改和删除的文件,忽略新创建的文件</span>
$ <span class="token function">git</span> <span class="token function">add</span> -u
<span class="token comment">#通过通配符添加文件</span>
$ <span class="token function">git</span> <span class="token function">add</span> *.java
<span class="token comment">#Git撤销add</span>
$ <span class="token function">git</span> reset <span class="token operator">&lt;</span>filename<span class="token operator">&gt;</span>
</code></pre></div><ol start="2"><li>git commit</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#提交所有修改的快照。这个选项只考虑git中已经添加的文件</span>
$ <span class="token function">git</span> commit -a
<span class="token comment">#修改最后一次的提交信息</span>
$ <span class="token function">git</span> commit -amend
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <ol><li><p><code>git commit</code><br>
如果没有设置 -m 选项，Git 默认会打开 <a href="/record/Linux命令行.html#_6-vim">vim</a> 提交信息</p></li> <li><p><code>git commit -a</code> 可以跳过<code>git add [file]</code><br> <code>git commit -a</code> 只能提交已经存在的文件，提交新建的文件时会失败</p></li></ol></div> <ol start="3"><li>git status</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">git</span> status <span class="token comment">#查看显示工作目录和暂存区的状态</span>
$ <span class="token function">git</span> status -s <span class="token comment">#紧凑的格式输出状态</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <ol><li><code>git status</code>不显示已经commit到项目历史中去的信息,查看项目历史的信息要使用<code>git log</code></li> <li><code>git status -s</code><br>
新添加的未跟踪文件前面有 ?? 标记，新添加到暂存区中的文件前面有 A 标记，修改过的文件前面有 M 标记。
M 有两个可以出现的位置，出现在右边的 M 表示该文件被修改了但是还没放入暂存区，出现在靠左边的 M 表示该文件被修改了并放入了暂存区。</li></ol></div> <ol start="4"><li>git diff</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#显示暂存区和工作区的差异</span>
$ <span class="token function">git</span> <span class="token function">diff</span>
<span class="token comment">#显示暂存区和本地仓库的差异</span>
$ <span class="token function">git</span> <span class="token function">diff</span> --staged <span class="token operator">||</span> $ <span class="token function">git</span> <span class="token function">diff</span> --cached <span class="token punctuation">[</span>file<span class="token punctuation">]</span>
<span class="token comment">#显示工作区和本地仓库的差异(HEAD 指向的是本地仓库中最新提交的版本)</span>
$ <span class="token function">git</span> <span class="token function">diff</span> HEAD
<span class="token comment">#显示两个提交之间的差异</span>
$ <span class="token function">git</span> <span class="token function">diff</span> <span class="token operator">&lt;</span>commit1-sha<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>commit2-sha<span class="token operator">&gt;</span>
<span class="token comment">#Git Diff 比较分支差异</span>
$ <span class="token function">git</span> <span class="token function">diff</span> <span class="token operator">&lt;</span>branch <span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span> <span class="token operator">&lt;</span> branch <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <ol><li><code>$ git diff HEAD^</code><br>
比较 workspace 与最新commit的前一次commit的差异</li> <li><code>$ git diff HEAD~2</code><br>
比较 workspace 与上2次提交的差异，相当于 git diff HEAD~2 HEAD~0，注意两个HEAD的位置，diff显示的结果表示 后一个(HEAD~0) 相对于 前一个的修改(HEAD~2)</li></ol></div> <ol start="5"><li>git log</li> <li>git stash<br>
git stash 命令使你能够在不提交当前分支的情况下切换分支，保存未完成的工作</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#保存工作内容</span>
$ <span class="token function">git</span> stash
<span class="token comment">#检查存储的藏品</span>
$ <span class="token function">git</span> stash list
<span class="token comment">#恢复工作内容</span>
$ <span class="token function">git</span> stash apply <span class="token operator">&lt;</span>stash id<span class="token operator">&gt;</span>
<span class="token comment">#恢复工作内容(保存记录会从git stash list删除)</span>
$ <span class="token function">git</span> stash pop
<span class="token comment">#查看文件在藏匿前和藏匿后的变化</span>
$ <span class="token function">git</span> stash show
<span class="token comment">#显示文件的变化内容</span>
$ <span class="token function">git</span> stash show -p
<span class="token comment">#删除保存内容的对列</span>
$ <span class="token function">git</span> stash drop <span class="token operator">&lt;</span>stash id<span class="token operator">&gt;</span>
<span class="token comment">#清空保存内容的对列</span>
$ <span class="token function">git</span> stash <span class="token function">clear</span>
<span class="token comment">#工作藏在某一新分支上</span>
$ <span class="token function">git</span> stash branch <span class="token operator">&lt;</span>Branch Name<span class="token operator">&gt;</span>
</code></pre></div><h3 id="git命令图解"><a href="#git命令图解" class="header-anchor">#</a> Git命令图解</h3> <p><img src="/imgs/record/git_problem/git%E6%B5%81%E7%A8%8B.png" alt="git命令"></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/fatsunshineboy/fatsunshineboy.github.io/edit/main/docs/record/Git_Learn_Experience.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">1/29/2023, 12:02:50 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/record/" class="prev router-link-active">
        杂记
      </a></span> <span class="next"><a href="/record/Git_Difficult.html">
        git疑难杂点
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><section class="side-anchor"><ul style="display:none;"></ul></section></div></div>
    <script src="/assets/js/app.49f5c377.js" defer></script><script src="/assets/js/2.d2c14998.js" defer></script><script src="/assets/js/5.42e8b644.js" defer></script>
  </body>
</html>
